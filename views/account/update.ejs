<div class="account-update-container">
  <h1><%= title %></h1>
  <%- messages() %>
  <% const accountInfo = typeof accountData !== "undefined" && accountData ? accountData : locals.accountData || {}; %>
  <% const stickyFirst = typeof account_firstname !== "undefined" ? account_firstname : accountInfo.account_firstname || ""; %>
  <% const stickyLast = typeof account_lastname !== "undefined" ? account_lastname : accountInfo.account_lastname || ""; %>
  <% const stickyEmail = typeof account_email !== "undefined" ? account_email : accountInfo.account_email || ""; %>
  <% const accountId = typeof account_id !== "undefined" ? account_id : accountInfo.account_id || ""; %>

  <% if (accountErrors && accountErrors.array && accountErrors.array().length) { %>
    <ul class="notice">
      <% accountErrors.array().forEach(error => { %>
        <li><%= error.msg %></li>
      <% }) %>
    </ul>
  <% } %>

  <form class="account-form" action="/account/update" method="post">
    <fieldset>
      <legend>Account Update</legend>
      <div class="form-field">
        <label for="account_firstname">First Name</label>
        <input type="text" id="account_firstname" name="account_firstname" required value="<%= stickyFirst %>">
      </div>

      <div class="form-field">
        <label for="account_lastname">Last Name</label>
        <input type="text" id="account_lastname" name="account_lastname" required value="<%= stickyLast %>">
      </div>

      <div class="form-field">
        <label for="account_email">Email</label>
        <input type="email" id="account_email" name="account_email" required value="<%= stickyEmail %>">
      </div>

      <input type="hidden" name="account_id" value="<%= accountId %>">

      <button type="submit">Update Account</button>
    </fieldset>
  </form>

  <% if (passwordErrors && passwordErrors.array && passwordErrors.array().length) { %>
    <ul class="notice">
      <% passwordErrors.array().forEach(error => { %>
        <li><%= error.msg %></li>
      <% }) %>
    </ul>
  <% } %>

  <form class="account-form" action="/account/update/password" method="post">
    <fieldset>
      <legend>Change Password</legend>
      <p>Enter a new password to replace your current one. Password must be at least 12 characters and include uppercase, number, and special character.</p>
      <div class="form-field">
        <label for="account_password">New Password</label>
        <input
          type="password"
          id="account_password"
          name="account_password"
          required
          pattern="^(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*]).{12,}$"
          title="Password must be at least 12 characters, include an uppercase letter, a number, and a special character.">
      </div>

      <input type="hidden" name="account_id" value="<%= accountId %>">

      <button type="submit">Change Password</button>
    </fieldset>
  </form>
</div>
